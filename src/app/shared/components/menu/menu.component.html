<!-- Menu Start -->
<section id="menu">
    <div class="container-xxl py-5">
        <div class="container">
            <div class="text-center wow fadeInUp" data-wow-delay="0.1s">
                <h5 class="section-title ff-secondary text-center text-primary fw-normal">Food Menu</h5>
                <h1 class="mb-5">Most Popular Items</h1>
            </div>
            <div class="tab-class text-center wow fadeInUp" data-wow-delay="0.1s">
                <!-- <ul class="nav nav-pills d-inline-flex justify-content-center border-bottom mb-5">
                    <li class="nav-item">
                        <a class="d-flex align-items-center text-start mx-3 ms-0 pb-3 active" data-bs-toggle="pill" href="#tab-1">
                            <i class="fa fa-coffee fa-2x text-primary"></i>
                            <div class="ps-3">
                                <small class="text-body">Popular</small>
                                <h6 class="mt-n1 mb-0">Breakfast</h6>
                            </div>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="d-flex align-items-center text-start mx-3 pb-3" data-bs-toggle="pill" href="#tab-2">
                            <i class="fa fa-hamburger fa-2x text-primary"></i>
                            <div class="ps-3">
                                <small class="text-body">Special</small>
                                <h6 class="mt-n1 mb-0">Launch</h6>
                            </div>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="d-flex align-items-center text-start mx-3 me-0 pb-3" data-bs-toggle="pill" href="#tab-3">
                            <i class="fa fa-utensils fa-2x text-primary"></i>
                            <div class="ps-3">
                                <small class="text-body">Lovely</small>
                                <h6 class="mt-n1 mb-0">Dinner</h6>
                            </div>
                        </a>
                    </li>
                </ul> -->
                <div class="tab-content">
                    <div id="tab-1" class="tab-pane fade show p-0 active">
                      <!-- Usamos un contenedor para manejar el layout -->
                      <div class="row g-4">
                        <!-- Recorremos el array de productos y colocamos las tarjetas en 3 columnas -->
                        <div *ngFor="let item of menuItems" class="col-md-6 col-lg-4">
                          <div class="card shadow-sm border-light">
                            <img class="card-img-top" [src]="item.PROD_VENTA_IMAGEN" alt="{{ item.PROD_VENTA_NOMBRE }}" style="height: 200px; object-fit: cover;">
                            <div class="card-body">
                              <h5 class="card-title d-flex justify-content-between">
                                <span>{{ item.PROD_VENTA_NOMBRE }}</span>
                                <span class="text-primary">{{formatCurrency(item.PROD_VENTA_PRECIO)  }}</span>
                              </h5>
                              <p class="card-text text-muted">{{ item.PROD_VENTA_DESCRIPCION }}</p>
                            </div>
                            <div class="card-footer text-center">
                              <!-- <button class="btn btn-outline-primary w-100" (click)="agregarCarrito(item)">Añadir al carrito</button> -->
                              <button (click)="openCustomizationModal(item)" class="btn btn-primary w-100">Añadir al carrito</button>

                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Modal de Bootstrap para personalizar el producto -->
                  <div class="modal fade" id="customizationModal" tabindex="-1" aria-labelledby="customizationModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg modal-dialog-centered">
                      <div class="modal-content">
                        <!-- Encabezado del modal -->
                        <div class="modal-header bg-primary text-white">
                          <h5 class="modal-title" id="customizationModalLabel">Personalizar Producto</h5>
                          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>

                        <!-- Cuerpo del modal en formato horizontal -->
                        <div class="modal-body">
                          <div class="container-fluid">
                            <div class="row">
                              <!-- Columna izquierda -->
                              <div class="col-md-6">
                                <!-- Tamaño del producto -->
                                <div class="mb-4">
                                  <label for="size" class="form-label h6">Tamaño del Producto</label>
                                  <select id="size" [(ngModel)]="selectedSize" class="form-select border border-primary shadow-sm">
                                    <option *ngFor="let size of sizes" [value]="size">{{ size }}</option>
                                  </select>
                                </div>

                                <!-- Ingredientes Extra -->
                                <div class="mb-4">
                                  <label class="form-label h6">Ingredientes Extra</label>
                                  <div class="p-3 border rounded shadow-sm bg-light">
                                    <div *ngFor="let ingredient of extraIngredients" class="form-check">
                                      <input type="checkbox" [(ngModel)]="ingredient.selected" class="form-check-input" [id]="ingredient.name">
                                      <label [for]="ingredient.name" class="form-check-label">
                                        {{ ingredient.name }} ({{ formatCurrency(ingredient.price) }})
                                      </label>
                                    </div>
                                  </div>
                                </div>  
                                
                                <!-- Selección de salsas -->
                                <div class="mb-4">
                                  <label class="form-label h6">Salsas</label>
                                  <div class="btn-group d-flex" role="group">
                                    <button *ngFor="let sauce of sauces" type="button" class="btn btn-outline-primary" [class.active]="sauce.selected" (click)="toggleSauce(sauce)">
                                      {{ sauce.name }}
                                    </button>
                                  </div>
                                </div>
                              </div>

                              <!-- Columna derecha -->
                              <div class="col-md-6">
                                <!-- Selector de cantidad -->
                                <div class="mb-3">
                                  <label for="quantity" class="form-label h6">Cantidad</label>
                                  <input type="number" id="quantity" class="form-control" [(ngModel)]="selectedQuantity" min="1" (change)="updateQuantity(selectedQuantity)">
                                </div>

                                <!-- Instrucciones especiales -->
                                <div class="mb-4">
                                  <label for="specialInstructions" class="form-label h6">Instrucciones Especiales</label>
                                  <textarea id="specialInstructions" [(ngModel)]="specialInstructions" class="form-control border border-primary shadow-sm" rows="3" placeholder="Ej: Sin cebolla, extra salsa"></textarea>
                                </div>

                                <!-- Resumen del costo total -->
                                <div class="mb-3 border-top pt-3">
                                  <p><strong>Costo Base:</strong> {{ formatCurrency(basePrice) }}</p>
                                  <p><strong>Ingredientes Adicionales:</strong> {{ formatCurrency(totalExtras) }}</p>
                                  <p><strong>Total:</strong> {{ formatCurrency(calculateTotalPrice()) }}</p>
                                </div>

                                <!-- Tiempo de preparación estimado -->
                                <div class="text-center my-3">
                                  <p class="text-muted"><i class="fas fa-clock"></i> Tiempo estimado de preparación: {{ estimatedPreparationTime }} minutos</p>
                                </div>

                                <!-- Información adicional de personalización -->
                                <div class="mb-3">
                                  <p class="mb-1"><strong>Tamaño seleccionado:</strong> {{ selectedSize || 'Ninguno' }}</p>
                                  <p><strong>Ingredientes seleccionados:</strong></p>
                                  <ul class="list-unstyled">
                                    <ng-container *ngFor="let ingredient of extraIngredients">
                                      <li *ngIf="ingredient.selected" class="d-flex justify-content-between">
                                        <span>{{ ingredient.name }}</span> 
                                        <span class="text-muted">{{ formatCurrency(ingredient.price) }}</span>
                                      </li>
                                    </ng-container>
                                  </ul>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>

                        <!-- Footer del modal -->
                        <div class="modal-footer bg-light d-flex">
                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                          <button type="button" class="btn btn-primary" (click)="productoPersonalizado()">Agregar al carrito</button>
                          <button type="button" class="btn btn-primary" (click)="productoPersonalizado()" [routerLink]="['/carrito']">Realizar pedido</button>
                        </div>
                      </div>
                    </div>
                  </div>
                  
            </div>
        </div>
    </div>
</section>
<!-- Menu End -->